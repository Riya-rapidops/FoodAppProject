{"ast":null,"code":"var _jsxFileName = \"/home/ad.rapidops.com/riya.panchal/Downloads/speedyfood-main/client/src/pages/Checkout/Components/StripeCard.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useState } from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { CardElement, Elements, useStripe, useElements } from '@stripe/react-stripe-js';\nimport { notEmpty, validatePinCode, ValidatePhone } from '../../../utils/functions';\nimport { useHistory } from \"react-router-dom\";\nimport { SweetConfirm, SweetError, SweetInfo, SweetSuccess, SweetWrong } from '../../../SweetAlert';\nimport { Context } from '../../../utils/context';\nimport api from '../../../utils/api';\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CheckoutForm = _ref => {\n  _s();\n  let {\n    checkOutDetails\n  } = _ref;\n  const stripe = useStripe();\n  const elements = useElements();\n  const [state, dispatch] = useContext(Context);\n  const [isClick, setIsClick] = useState(true);\n  const history = useHistory();\n  const handleSubmit = async () => {\n    setIsClick(true);\n    if (ValidatePhone(checkOutDetails.phone) && notEmpty(checkOutDetails.address, \"Address\") && notEmpty(checkOutDetails.city, \"City\") && validatePinCode(checkOutDetails.pinCode)) {\n      try {\n        const {\n          error,\n          paymentMethod\n        } = await (stripe === null || stripe === void 0 ? void 0 : stripe.createPaymentMethod({\n          type: 'card',\n          card: elements.getElement(CardElement)\n        }));\n        if (error) SweetInfo(error.message);else {\n          const {\n            id\n          } = paymentMethod;\n          const placeOrderDetails = {\n            checkOutDetails,\n            token: id\n          };\n          SweetConfirm();\n          const res = await api.post('/placeorder', placeOrderDetails);\n          const {\n            success,\n            error\n          } = res.data;\n          if (success) {\n            SweetSuccess(success);\n            dispatch({\n              type: 'EMPTY_CART'\n            });\n            history.push('/orders');\n          } else SweetError(error);\n        }\n      } catch (error) {\n        SweetWrong();\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 mx-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"input-label\",\n        htmlFor: \"card\",\n        children: \"Card Details\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(CardElement, {\n        options: {\n          hidePostalCode: true\n        },\n        className: \"bg-white p-3 shadow rounded-md\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 mx-4\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `mt-10 w-full checkout-btn btn3`,\n        onClick: handleSubmit,\n        children: `Pay ${checkOutDetails === null || checkOutDetails === void 0 ? void 0 : checkOutDetails.TotalPrice}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n_s(CheckoutForm, \"sxnvFFIyc8EC3inm1AdLYfiDsoY=\", false, function () {\n  return [useStripe, useElements, useHistory];\n});\n_c = CheckoutForm;\nconst stripePromise = loadStripe(\"pk_test_51MJ9NfSF8MhYykNnsEByQtL1xnhF0WbhslqA69d7rySoOb7MngkF5h5F4C0r6PRcOuj6P4l9N9j0II63IS5ck11C00GqKkDFwr\");\nconst StripeCard = _ref2 => {\n  let {\n    checkOutDetails\n  } = _ref2;\n  return /*#__PURE__*/_jsxDEV(Elements, {\n    stripe: stripePromise,\n    children: /*#__PURE__*/_jsxDEV(CheckoutForm, {\n      checkOutDetails: checkOutDetails\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 9\n  }, this);\n};\n_c2 = StripeCard;\nexport default StripeCard;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"StripeCard\");","map":{"version":3,"names":["React","useContext","useState","loadStripe","CardElement","Elements","useStripe","useElements","notEmpty","validatePinCode","ValidatePhone","useHistory","SweetConfirm","SweetError","SweetInfo","SweetSuccess","SweetWrong","Context","api","CheckoutForm","checkOutDetails","stripe","elements","state","dispatch","isClick","setIsClick","history","handleSubmit","phone","address","city","pinCode","error","paymentMethod","createPaymentMethod","type","card","getElement","message","id","placeOrderDetails","token","res","post","success","data","push","hidePostalCode","TotalPrice","stripePromise","StripeCard"],"sources":["/home/ad.rapidops.com/riya.panchal/Downloads/speedyfood-main/client/src/pages/Checkout/Components/StripeCard.js"],"sourcesContent":["import React, { useContext, useState } from 'react'\nimport {loadStripe} from '@stripe/stripe-js'\nimport {\n  CardElement,\n  Elements,\n  useStripe,\n  useElements,\n} from '@stripe/react-stripe-js'\nimport { \n  notEmpty,\n  validatePinCode,\n  ValidatePhone } from '../../../utils/functions'\nimport { useHistory } from \"react-router-dom\"\nimport { SweetConfirm, SweetError, SweetInfo, SweetSuccess, SweetWrong } from '../../../SweetAlert'\nimport { Context } from '../../../utils/context'\nimport api from '../../../utils/api'\n\n\nconst CheckoutForm = ({checkOutDetails}) => {\n    const stripe = useStripe()\n\n    const elements = useElements()\n\n    const [state, dispatch] = useContext(Context)\n\n    const [isClick, setIsClick] = useState(true)\n\n    const history = useHistory()\n    \n    const handleSubmit = async () => {\n\n    setIsClick(true)\n\n    if(ValidatePhone(checkOutDetails.phone)  && notEmpty(checkOutDetails.address,\"Address\") \n          && notEmpty(checkOutDetails.city,\"City\") && validatePinCode(checkOutDetails.pinCode)) {\n        try {\n            const {error, paymentMethod} = await stripe?.createPaymentMethod({\n                type: 'card',\n                card: elements.getElement(CardElement),\n            })\n            \n            if(error)\n                SweetInfo(error.message) \n            else {\n                const { id } = paymentMethod\n                const placeOrderDetails = {\n                    checkOutDetails,\n                    token:id\n                }\n                SweetConfirm()\n\n                const res = await api.post('/placeorder',placeOrderDetails)\n                const { success , error  } = res.data  \n                \n                if(success){\n                    SweetSuccess(success)\n                    dispatch({type:'EMPTY_CART'})\n                    history.push('/orders')\n                }\n                else\n                    SweetError(error)     \n                }\n            } catch (error) {   \n                SweetWrong() \n        }\n    }   \n}\n\n    return (\n      <>\n        <div className=\"mb-4 mx-3\">\n            <label className=\"input-label\" htmlFor=\"card\">Card Details</label>\n            <CardElement options={{hidePostalCode:true}} className=\"bg-white p-3 shadow rounded-md\"/>\n        </div>\n        <div className=\"mb-4 mx-4\">\n            <button className={`mt-10 w-full checkout-btn btn3`} onClick={handleSubmit}>\n                {`Pay ${checkOutDetails?.TotalPrice}`}\n            </button>\n        </div>\n      </>\n    )\n  }\n\nconst stripePromise = loadStripe(\"pk_test_51MJ9NfSF8MhYykNnsEByQtL1xnhF0WbhslqA69d7rySoOb7MngkF5h5F4C0r6PRcOuj6P4l9N9j0II63IS5ck11C00GqKkDFwr\");\n\nconst StripeCard = ({checkOutDetails}) => {\n    return (\n        <Elements stripe={stripePromise}>\n            <CheckoutForm checkOutDetails={checkOutDetails}/>\n        </Elements>\n    )\n}\n\nexport default StripeCard"],"mappings":"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"},"metadata":{},"sourceType":"module"}